Credit to notzastic for the GUI code
